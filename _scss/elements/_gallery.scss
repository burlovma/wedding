


.gallery {
  border-color: $border-color;
  border-width: 1px 0;
  border-style: solid;

  .container {
    max-width: $container;
    padding: 0;
  }

  .block {
    float: left;
    padding: em(.5);
    width: 50%;
  }

  .img {
    display: block;
    height: 0;
    padding-bottom: 100%;
    position: relative;

    img {
      height: 100%;
      left: 0;
      margin: auto;
      position: absolute;
      top: 0;
      width: 100%;

      @include opacity(0);
      @include custom-transition(opacity $animation-timing ease);

      &.lazy-loaded {
        @include opacity(1);
      }
    }
  }

  .caption-container {
    display: none;

    .caption {
      color: lighten($gray, 10);
      display: inherit;
      font: 400 .813em/1.5 $condensed-font-family;
    }
  }

  // @media (max-width: em(479)) {
  //   .block:nth-child(5n+1) { width: 100%; }
  // }

  // what we did originally
  // @media (min-width: em(480)) and (max-width: em(767)) {
  //   .block:nth-child(-n+4), // 1 - 4
  //   .block:nth-child(n+8):nth-child(-n+11), // 8 - 11
  //   .block:nth-child(n+16):nth-child(-n+23), // 16 - 23
  //   .block:nth-child(n+26):nth-child(-n+29), // 26 - 29
  //   .block:nth-child(n+33):nth-child(-n+36) // 33 - 36
  //   { width: 25%; }
  // }

  @media (min-width: em(480)) and (max-width: em(767)) {
    .block {
      width: percentage(1 / 3);

      &:nth-child(6n+1) { width: percentage(2 / 3); }

      $childs: 7 19 31;

      @each $child in $childs {
        &:nth-child(#{$child}) { float: right; }
      }

      $clears: 4 10 16 22 28 34;

      @each $clear in $clears {
        &:nth-child(#{$clear}) { clear: left; }
      }
    }
  }

  @include breakpoints(tablet) {
    .block {
      overflow: hidden;
      position: relative;
      width: 25%;

      &:nth-child(9n+1) { width: 50%; }

      $childs: 10 28;

      @each $child in $childs {
        &:nth-child(#{$child}) { float: right; }
      }

      $clears: 6 15 24 33;

      @each $clear in $clears {
        &:nth-child(#{$clear}) { clear: left; }
      }

      .caption-container {
        display: block;
        height: 100%;
        left: em(.5);
        padding: 10px;
        position: absolute;
        right: em(.5);
        top: 100%;

        @include custom-transition(top $animation-timing ease);

        .caption-gradient {
          background: transparentize($black, .2);
          bottom: 0;
          left: 0px;
          padding: 10px;
          position: absolute;
          width: 100%;

          @include linearGradient(transparentize($black, 1), transparentize($black, .2));
        }

        .caption {
          color: $white;
        }
      }

      &:hover .caption-container { top: 0; }
    }
  }
}